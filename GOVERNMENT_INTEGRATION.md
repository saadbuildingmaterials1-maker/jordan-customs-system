# نظام التكامل مع الجهات الحكومية
## الربط مع نظام الجمارك الأردنية الرسمي

---

## 1. نظرة عامة على المعمارية

### المكونات الرئيسية:
```
┌─────────────────────────────────────────────────────────────┐
│                   تطبيق إدارة التكاليف                      │
│                 (Web + Desktop + Mobile)                    │
└────────────────────┬────────────────────────────────────────┘
                     │
                     ▼
┌─────────────────────────────────────────────────────────────┐
│              طبقة التكامل والتوسيط (Integration Layer)      │
│  - معالجة الطلبات والاستجابات                              │
│  - تحويل البيانات بين الصيغ المختلفة                        │
│  - إدارة الأخطاء والإعادة                                   │
└────────────────────┬────────────────────────────────────────┘
                     │
        ┌────────────┼────────────┐
        ▼            ▼            ▼
┌──────────────┐ ┌──────────────┐ ┌──────────────┐
│ نظام الجمارك │ │ نظام الضرائب │ │ نظام الشحن  │
│ الأردنية    │ │ والرسوم      │ │ والتتبع     │
└──────────────┘ └──────────────┘ └──────────────┘
```

---

## 2. واجهات API للتكامل

### 2.1 API الجمارك الأردنية

#### نقاط النهاية الرئيسية:
- `POST /api/customs/declaration` - إرسال بيان جمركي جديد
- `GET /api/customs/declaration/{id}` - الحصول على حالة البيان
- `PUT /api/customs/declaration/{id}` - تحديث البيان
- `GET /api/customs/tariff-codes` - الحصول على قائمة الرموز الجمركية
- `POST /api/customs/validate` - التحقق من صحة البيان

#### صيغة الطلب:
```json
{
  "declarationNumber": "JD-2026-001234",
  "declarationType": "import",
  "declarationDate": "2026-01-23T10:30:00Z",
  "importer": {
    "name": "شركة الاستيراد",
    "taxId": "123456789",
    "address": "عمّان، الأردن"
  },
  "items": [
    {
      "hsCode": "6204.62.20",
      "description": "ملابس نسائية",
      "quantity": 100,
      "unit": "piece",
      "unitPrice": 15.50,
      "currency": "USD",
      "totalValue": 1550.00
    }
  ],
  "totalValue": 1550.00,
  "currency": "USD"
}
```

#### صيغة الاستجابة:
```json
{
  "status": "success",
  "declarationId": "GOV-2026-001234",
  "referenceNumber": "REF-2026-001234",
  "status": "pending_review",
  "estimatedTaxes": {
    "customsDuty": 155.00,
    "salesTax": 46.50,
    "total": 201.50
  },
  "nextSteps": [
    "دفع الرسوم الجمركية",
    "تقديم الوثائق المطلوبة",
    "فحص البضاعة"
  ]
}
```

### 2.2 API نظام الضرائب

#### نقاط النهاية:
- `POST /api/tax/calculate` - حساب الضرائب
- `GET /api/tax/rates` - الحصول على أسعار الضرائب الحالية
- `POST /api/tax/filing` - تقديم إقرار ضريبي

### 2.3 API نظام الشحن والتتبع

#### نقاط النهاية:
- `POST /api/shipping/track` - تتبع الشحنة
- `GET /api/shipping/status/{trackingId}` - الحصول على حالة الشحنة
- `POST /api/shipping/notify` - إرسال إشعارات

---

## 3. نظام المزامنة الفورية

### 3.1 آلية المزامنة:
```
تطبيقنا → API الجمارك
   ↓
   ├─ إرسال البيان
   ├─ انتظار التأكيد
   ├─ تحديث الحالة محلياً
   └─ إرسال إشعارات للمستخدم
```

### 3.2 معالجة الأخطاء:
- إعادة المحاولة التلقائية (Exponential Backoff)
- تسجيل الأخطاء والتنبيهات
- تخزين مؤقت للبيانات (Queue System)

---

## 4. نظام الأمان والاستيثاقات

### 4.1 أنواع الاستيثاق:
- **OAuth 2.0** - للمستخدمين الحكوميين
- **API Keys** - للتطبيقات المعتمدة
- **Digital Certificates** - للتوقيع الرقمي
- **Two-Factor Authentication** - للعمليات الحساسة

### 4.2 التشفير:
- TLS 1.3 لجميع الاتصالات
- AES-256 لتشفير البيانات المحلية
- SHA-256 لتجزئة البيانات الحساسة

---

## 5. لوحة تحكم التكامل

### 5.1 المميزات:
- عرض حالة الاتصال بالأنظمة الحكومية
- مراقبة عدد البيانات المرسلة/المستقبلة
- تسجيل جميع العمليات (Audit Log)
- تقارير الأخطاء والتنبيهات
- إدارة المفاتيح والشهادات

### 5.2 المقاييس المراقبة:
- وقت الاستجابة (Response Time)
- معدل النجاح (Success Rate)
- عدد الأخطاء (Error Count)
- حجم البيانات المنقولة (Data Volume)

---

## 6. خطط التطوير المستقبلية

### المرحلة 1 (الحالية):
- ✅ تصميم المعمارية
- ⏳ بناء واجهات API
- ⏳ نظام المزامنة الفورية
- ⏳ نظام الأمان

### المرحلة 2:
- [ ] التكامل مع نظام الضرائب الأردني
- [ ] التكامل مع نظام الشحن والتتبع
- [ ] نظام الإشعارات الفورية

### المرحلة 3:
- [ ] التكامل مع الجهات الحكومية الأخرى
- [ ] نظام التقارير الحكومية
- [ ] نظام الأرشفة الرقمية

---

## 7. متطلبات التطوير

### البرامج المطلوبة:
- Node.js 22+
- Express.js 4+
- TypeScript 5+
- Axios للطلبات HTTP
- jsonwebtoken للتوقيع الرقمي

### المكتبات الإضافية:
```bash
npm install axios jsonwebtoken crypto-js dotenv
```

---

## 8. معايير الامتثال

### المعايير المطلوبة:
- ISO 27001 - معايير الأمان المعلوماتي
- ISO 9001 - معايير إدارة الجودة
- GDPR - حماية البيانات الشخصية
- معايير الجمارك الأردنية

---

## 9. التوثيق والدعم

### الموارد:
- [دليل API الجمارك الأردنية](https://customs.gov.jo/api-docs)
- [دليل نظام الضرائب](https://tax.gov.jo/api-docs)
- [معايير البيانات الجمركية](https://standards.gov.jo)

### الدعم الفني:
- البريد الإلكتروني: integration@customs.gov.jo
- الهاتف: +962-6-5629000
- ساعات العمل: السبت - الخميس، 8:00 - 16:00

---

**آخر تحديث:** 23 يناير 2026
**الإصدار:** 1.0.0
**الحالة:** قيد التطوير
