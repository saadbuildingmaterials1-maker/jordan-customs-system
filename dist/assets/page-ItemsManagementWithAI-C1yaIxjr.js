import{r as c,l as e}from"./vendor-react-Dgdo4XhX.js";import{c5 as J,J as B,a5 as d,ar as Q,ai as p,ac as R,aq as n}from"./vendor-utils-B_Whsovj.js";import{t as i}from"./lib-CTze1SoS.js";import{B as N,C as z,b as H,c as U,a as G,I as K,bl as X,bm as Y,bo as Z}from"./components-BtZCaOnd.js";import"./vendor-scoped-DzuYsGtF.js";import"./vendor-form-D568bDq1.js";import"./vendor-lodash-2aBc-CpY.js";import"./vendor-date-uKCwvQwo.js";import"./vendor-clsx-B-dksMZM.js";import"./vendor-ui-BExRobFU.js";import"./vendor-tailwind-3LUZTPgX.js";import"./vendor-uuid-BKrj-4V8.js";import"./contexts-COgUEl2j.js";import"./page-AccountingDashboard-6oJpbcfq.js";import"./vendor-charts-DtYAaXfM.js";import"./hooks-DKZzJ-gV.js";function ge(){const[,j]=J("/declarations/:id/items"),a=j?.id;B();const[W,o]=c.useState(!1),[m,r]=c.useState(null),[h,v]=c.useState(""),[C,g]=c.useState(!1),[b,x]=c.useState("classification"),[D,f]=c.useState(null),{data:s,isLoading:E}=i.customs.getDeclaration.useQuery({id:parseInt(a)},{enabled:!!a}),{data:V=[],isLoading:w,refetch:I}=i.customs.getItems?.useQuery?.({declarationId:parseInt(a)},{enabled:!!a})||{data:[],isLoading:!1,refetch:async()=>{}},M=i.customs.addItem?.useMutation?.()||{mutateAsync:async()=>{}},y=i.customs.updateItem?.useMutation?.()||{mutateAsync:async()=>{}},S=i.customs.deleteItem?.useMutation?.()||{mutateAsync:async()=>{}},L=i.ai.suggestItemClassification.useMutation(),l=i.ai.analyzeDeclaration.useMutation(),u=i.ai.predictCosts.useMutation(),P=async t=>{if(a)try{await M.mutateAsync({declarationId:parseInt(a),...t}),n.success("تم إضافة الصنف بنجاح"),o(!1),await I()}catch{n.error("حدث خطأ أثناء إضافة الصنف")}},T=async t=>{if(m)try{await y.mutateAsync({id:m.id,quantity:t.quantity,unitPriceForeign:t.unitPriceForeign,customsCode:t.customsCode,description:t.description}),n.success("تم تحديث الصنف بنجاح"),r(null),await I()}catch{n.error("حدث خطأ أثناء تحديث الصنف")}},k=async t=>{try{await S.mutateAsync({id:t}),n.success("تم حذف الصنف بنجاح"),await I()}catch{n.error("حدث خطأ أثناء حذف الصنف")}},O=async()=>{if(s)try{x("analysis");const t=await l.mutateAsync({declarationId:parseInt(a),declarationNumber:s.declarationNumber,exportCountry:s.exportCountry,totalFobValue:Number(s.fobValueJod)});f(t),g(!0)}catch{n.error("فشل التحليل الذكي")}},q=async()=>{if(s)try{x("prediction");const t=await u.mutateAsync({declarationId:parseInt(a),fobValue:Number(s.fobValueJod),freightCost:Number(s.freightCost),insuranceCost:Number(s.insuranceCost),exportCountry:s.exportCountry});f(t),g(!0)}catch{n.error("فشل توقع التكاليف")}},F=V.filter(t=>t.itemName.toLowerCase().includes(h.toLowerCase())||t.itemCode?.toLowerCase().includes(h.toLowerCase()));return E?e.jsxDEV("div",{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:165",className:"flex items-center justify-center py-12",children:e.jsxDEV(d,{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:166",className:"h-8 w-8 animate-spin"},void 0,!1,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:166,columnNumber:9},this)},void 0,!1,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:165,columnNumber:7},this):e.jsxDEV("div",{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:172",className:"space-y-6 p-6",children:[e.jsxDEV("div",{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:174",className:"flex items-center justify-between",children:[e.jsxDEV("h1",{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:175",className:"text-3xl font-bold",children:"إدارة الأصناف"},void 0,!1,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:175,columnNumber:9},this),e.jsxDEV(N,{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:176",onClick:()=>o(!0),className:"gap-2",children:[e.jsxDEV(Q,{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:177",className:"h-4 w-4"},void 0,!1,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:177,columnNumber:11},this),"إضافة صنف جديد"]},void 0,!0,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:176,columnNumber:9},this)]},void 0,!0,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:174,columnNumber:7},this),e.jsxDEV(z,{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:183",className:"border-blue-200 bg-blue-50",children:[e.jsxDEV(H,{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:184",children:e.jsxDEV(U,{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:185",className:"flex items-center gap-2 text-right",children:[e.jsxDEV(p,{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:186",className:"h-5 w-5 text-blue-600"},void 0,!1,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:186,columnNumber:13},this),"أدوات الذكاء الاصطناعي"]},void 0,!0,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:185,columnNumber:11},this)},void 0,!1,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:184,columnNumber:9},this),e.jsxDEV(G,{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:190",className:"flex flex-wrap gap-3",children:[e.jsxDEV(N,{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:191",onClick:O,disabled:l.isPending,variant:"outline",className:"gap-2",children:[l.isPending?e.jsxDEV(d,{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:198",className:"h-4 w-4 animate-spin"},void 0,!1,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:198,columnNumber:15},this):e.jsxDEV(p,{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:200",className:"h-4 w-4"},void 0,!1,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:200,columnNumber:15},this),"تحليل ذكي للبيان"]},void 0,!0,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:191,columnNumber:11},this),e.jsxDEV(N,{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:205",onClick:q,disabled:u.isPending,variant:"outline",className:"gap-2",children:[u.isPending?e.jsxDEV(d,{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:212",className:"h-4 w-4 animate-spin"},void 0,!1,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:212,columnNumber:15},this):e.jsxDEV(p,{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:214",className:"h-4 w-4"},void 0,!1,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:214,columnNumber:15},this),"توقع التكاليف"]},void 0,!0,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:205,columnNumber:11},this)]},void 0,!0,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:190,columnNumber:9},this)]},void 0,!0,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:183,columnNumber:7},this),e.jsxDEV("div",{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:222",className:"relative",children:[e.jsxDEV(R,{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:223",className:"absolute right-3 top-3 h-4 w-4 text-gray-400"},void 0,!1,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:223,columnNumber:9},this),e.jsxDEV(K,{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:224",placeholder:"ابحث عن صنف أو رمز...",value:h,onChange:t=>v(t.target.value),className:"pl-4 pr-10"},void 0,!1,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:224,columnNumber:9},this)]},void 0,!0,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:222,columnNumber:7},this),w?e.jsxDEV("div",{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:234",className:"flex items-center justify-center py-12",children:e.jsxDEV(d,{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:235",className:"h-8 w-8 animate-spin"},void 0,!1,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:235,columnNumber:11},this)},void 0,!1,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:234,columnNumber:9},this):e.jsxDEV(X,{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:238",items:F,onEdit:t=>{r(t),o(!0)},onDelete:k,onAddNew:()=>o(!0)},void 0,!1,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:238,columnNumber:9},this),e.jsxDEV(Y,{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:250",isOpen:W,onClose:()=>{o(!1),r(null)},onSubmit:m?T:P,initialData:m,isLoading:M.isPending||y.isPending},void 0,!1,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:250,columnNumber:7},this),e.jsxDEV(Z,{"data-loc":"client/src/pages/ItemsManagementWithAI.tsx:262",isOpen:C,onClose:()=>g(!1),type:b,data:D,isLoading:L.isPending||l.isPending||u.isPending,onAccept:t=>{b==="classification"&&m&&r({...m,customsCode:t.suggestedCustomsCode})}},void 0,!1,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:262,columnNumber:7},this)]},void 0,!0,{fileName:"/home/ubuntu/jordan-customs-system/client/src/pages/ItemsManagementWithAI.tsx",lineNumber:172,columnNumber:5},this)}export{ge as default};
