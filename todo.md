# نظام إدارة تكاليف الشحن والجمارك الأردنية - قائمة المهام

## المرحلة 1: البنية الأساسية وقاعدة البيانات
- [x] تصميم وإنشاء جداول قاعدة البيانات (البيانات الجمركية، الأصناف، التفاصيل المالية)
- [x] إنشاء نماذج Drizzle ORM للجداول
- [x] إنشاء دوال مساعدة في server/db.ts للاستعلامات

## المرحلة 2: الواجهات والمكونات الأساسية
- [x] تصميم وتطبيق نمط التصميم الأنيق (Elegant Style) مع الألوان والخطوط
- [x] إنشاء مكون DashboardLayout مخصص للنظام
- [x] إنشاء مكونات مشتركة (Headers, Cards, Forms)
- [x] تطبيق دعم اللغة العربية والأرقام العربية
- [x] إعداد CSS والمتغيرات الأساسية

## المرحلة 3: نموذج إدخال البيانات الجمركية
- [x] بناء نموذج إدخال تفاصيل البيان الجمركي
- [x] إضافة حقول: رقم البيان، التاريخ، مركز التخليص، سعر التعادل، بلد التصدير، بوليصة الشحن
- [x] إنشاء إجراء tRPC لحفظ البيانات الجمركية
- [x] التحقق من صحة البيانات المدخلة

## المرحلة 4: نموذج تفاصيل الأوزان والطرود
- [x] بناء نموذج إدخال الأوزان والطرود
- [x] إضافة حقول: الوزن القائم، الوزن الصافي، عدد الطرود، نوع الطرود
- [x] ربط البيانات مع البيان الجمركي

## المرحلة 5: نموذج إدخال الأصناف والقيم
- [x] بناء نموذج إدخال الأصناف (في إجراء tRPC)
- [x] إضافة حقول: اسم الصنف، الكمية، سعر الوحدة (أجنبي)، إجمالي السعر
- [x] حساب القيمة بالدينار الأردني
- [x] حساب نسبة القيمة من إجمالي الشحنة

## المرحلة 6: حساب الرسوم والضرائب الجمركية
- [x] بناء نموذج إدخال الرسوم والضرائب
- [x] حساب قيمة البضاعة FOB
- [x] حساب أجور الشحن والتأمين
- [x] حساب الرسوم الجمركية
- [x] حساب ضريبة المبيعات 16%
- [x] حساب الرسوم الإضافية والخدمات والغرامات
- [x] إنشاء إجراء tRPC لحساب التكاليف

## المرحلة 7: حساب تكلفة الوحدة (Landed Unit Cost)
- [x] بناء نموذج حساب تكلفة الوحدة
- [x] توزيع المصاريف الإضافية حسب نسبة قيمة كل صنف
- [x] حساب إجمالي تكلفة كل صنف واصل
- [x] حساب تكلفة الوحدة الواحدة بالدينار الأردني

## المرحلة 8: لوحة التحكم الذكية
- [ ] بناء لوحة التحكم الرئيسية
- [ ] عرض ملخص هيكل التكاليف
- [ ] عرض إجمالي قيمة البضاعة
- [ ] عرض إجمالي الشحن والتأمين
- [ ] عرض إجمالي الرسوم والضرائب
- [ ] عرض التكلفة الكلية النهائية
- [ ] عرض نسبة المصاريف الإضافية

## المرحلة 9: مقارنة التكاليف والانحراف
- [ ] إضافة حقول التكاليف التقديرية
- [ ] حساب الانحراف (Variance) بين الفعلي والتقديري
- [ ] حساب نسبة الانحراف المئوية
- [ ] عرض التحليل البياني للانحرافات

## المرحلة 10: إدارة السجلات والبيانات التاريخية
- [ ] بناء صفحة قائمة البيانات الجمركية السابقة
- [ ] إضافة إمكانية البحث والفلترة
- [ ] إضافة إمكانية تعديل السجلات
- [ ] إضافة إمكانية حذف السجلات
- [ ] إضافة إمكانية استعادة البيانات

## المرحلة 11: التقارير والتصدير
- [ ] بناء صفحة التقارير
- [ ] إضافة إمكانية تصدير PDF
- [ ] إضافة إمكانية تصدير Excel
- [ ] تصميم قالب التقرير الاحترافي
- [ ] تضمين جميع التفاصيل المالية والجمركية

## المرحلة 12: الواجهة الأنيقة والتحسينات
- [ ] تحسين التصميم البصري الشامل
- [ ] إضافة الرسوم التوضيحية والرموز
- [ ] تحسين تجربة المستخدم (UX)
- [ ] إضافة الرسوم البيانية والمخططات
- [ ] اختبار الاستجابة على جميع الأجهزة

## المرحلة 13: الاختبار والتحسينات النهائية
- [ ] كتابة اختبارات Vitest للحسابات
- [ ] اختبار جميع الحقول والنماذج
- [ ] اختبار الحسابات المالية
- [ ] اختبار التقارير والتصدير
- [ ] تحسينات الأداء والأمان


## المرحلة 8: نموذج إدارة الأصناف المتقدم
- [x] بناء صفحة عرض تفاصيل البيان الجمركي
- [x] إنشاء مكون جدول الأصناف مع عرض التفاصيل
- [x] بناء نموذج إضافة صنف جديد (Modal)
- [x] بناء نموذج تعديل الصنف
- [x] إضافة زر حذف الصنف مع تأكيد
- [x] حساب التكاليف تلقائياً عند إضافة/تعديل صنف
- [x] تحديث الملخص المالي تلقائياً

## المرحلة 9: صفحة عرض التفاصيل
- [ ] عرض معلومات البيان الجمركي الأساسية
- [ ] عرض جدول الأصناف مع التفاصيل المالية
- [ ] عرض ملخص التكاليف الشامل
- [ ] عرض الانحرافات والمقارنات

## المرحلة 10: التقارير والتصدير
- [ ] إضافة إمكانية تصدير PDF
- [ ] إضافة إمكانية تصدير Excel
- [ ] تصميم قالب التقرير الاحترافي


## المرحلة 11: ميزة التصدير والتقارير
- [x] بناء خدمة تصدير Excel مع مكتبة ExcelJS
- [x] بناء خدمة تصدير PDF مع مكتبة jsPDF
- [x] إضافة شعار الشركة في رأس التقارير
- [x] تنسيق التقارير بشكل احترافي
- [x] إضافة جداول البيانات في التقارير
- [x] إضافة الملخصات المالية في التقارير

## المرحلة 12: ميزة تحليل الانحرافات
- [x] بناء صفحة مقارنة الانحرافات
- [x] إضافة نموذج إدخال التكاليف التقديرية
- [x] رسوم بيانية مقارنة الأعمدة
- [x] رسوم بيانية الانحرافات
- [x] جدول تفصيلي للانحرافات
- [x] روابط الملخصات المالية

## المرحلة 13: تحسين نموذج الإدخال المتقدم
- [x] إضافة حقل رقم الباركود
- [x] إضافة حقل رقم المرجع المصري
- [x] إضافة حقل رقم الرخصة للمستورد
- [x] إضافة حقل رقم الرقم الضريبي للمستورد
- [x] إضافة حقل رقم الرقم التسلسلي للمستورد
- [x] إضافة حقل رقم الترخيص للشركة المصدرة
- [x] إضافة حقل رقم بوليصة الشحن
- [x] إضافة حقل الحجم (CBM)
- [x] إضافة حقل الكود الجمركي للأصناف
- [x] إضافة حقل رقم الشهادة النهاية
- [x] إضافة حقل رقم المعاملة
- [x] إضافة حقل الملاحظات العامة


## المرحلة 14: نموذج متقدم لإدارة الأصناف مع رموز فريدة
- [x] إضافة حقل رقم رمز فريد لكل صنف (SKU/Item Code)
- [x] إنشاء صفحة إدارة الأصناف المتقدمة (ItemsManagement)
- [x] إضافة نموذج إضافة صنف متقدم مع رقم رمز تلقائي
- [x] إضافة خاصية البحث والتصفية حسب رقم الرمز
- [x] إضافة جدول تفصيلي للأصناف مع جميع التفاصيل
- [x] إضافة خاصية التعديل السريع للأصناف
- [x] إضافة خاصية الحذف الآمن للأصناف
- [x] ربط رقم الرمز مع البيان الجمركي

## المرحلة 15: دمج الذكاء الاصطناعي
- [x] إنشاء خدمة AI للتحليل الذكي
- [x] إضافة اقتراحات ذكية لتصنيف الأصناف
- [x] إضافة كشف الأخطاء والتحذيرات الذكية
- [x] إضافة توقعات الرسوم الجمركية بناءً على البيانات التاريخية

## المرحلة 16: صفحة اختبار شاملة
- [ ] إنشاء صفحة اختبار شاملة (Testing Dashboard)
- [ ] إضافة اختبارات للصفحات الرئيسية
- [ ] إضافة اختبارات للنماذج والحقول
- [ ] إضافة اختبارات للحسابات المالية
- [ ] إضافة اختبارات للحفظ والاسترجاع
- [ ] إضافة اختبارات للتصدير والتقارير
- [ ] إضافة اختبارات الأداء والسرعة
- [ ] إضافة تقرير نتائج الاختبار
